source('~/Dropbox/tcorpus/R/preprocessing.r')
source('~/Dropbox/tcorpus/R/preprocessing.r')
words = c('this','is','a','test','this','is','a','glorious','test','ok')
group = c(1,1,1,1,2,2,2,2,2,2)
filter = c(T,F,T,T,T,T,T,F,T,T)
n=3
no_label=T
grouped_ngrams(words,group,n)
source('~/Dropbox/tcorpus/R/preprocessing.r')
create_ngrams <- function(words, group, n, label=T, hash=F) {
ngrams = matrix(ncol=n, nrow=length(words))
for(i in 1:n) ngrams[,n-i+1] = shift(words, n=i-1, fill = '')
newart = which(!duplicated(group))
for(i in 1:(n-1)) {
replace_i = newart+i-1
replace_i = replace_i[replace_i <= nrow(ngrams)]
if (length(replace_i) > 0) ngrams[replace_i, 1:(n-i)] = ''
}
ngrams = split(t(ngrams), rep(1:nrow(ngrams), each = ncol(ngrams)))
ungrams = unique(ngrams)
if(hash) {
require(digest)
ashash <- function(x) readBin(digest::digest(x, 'sha1', raw=T), what='integer')
hash = as.integer(sapply(ungrams, ashash))
return(hash)
} else {
ngrams_i = match(ngrams, ungrams)
ungrams = if (label) stringi::stri_paste_list(ungrams, sep='/') else 1:length(ungrams)
return(ungrams[ngrams_i])
}
}
grouped_ngrams <- function(words, group, n, filter=rep(T, length(words)), label=T, hash=F){
filter = filter & !is.na(words)
words = words[filter]
group = if (length(group) == 1) rep(group, length(words)) else group[filter]
ngrams = vector('character', length(filter))
ngrams[which(filter)] = create_ngrams(words, group, n, label=label, hash=hash)
as.factor(ngrams)
}
words = c('this','is','a','test','this','is','a','glorious','test','ok')
group = c(1,1,1,1,2,2,2,2,2,2)
filter = c(T,F,T,T,T,T,T,F,T,T)
n=3
no_label=T
grouped_ngrams(words,group,n)
grouped_ngrams(words,group,n, label=F)
grouped_ngrams(words,group,n, label=F, hash=T)
source('~/Dropbox/tcorpus/R/preprocessing.r')
words = c('this','is','a','test','this','is','a','glorious','test','ok')
group = c(1,1,1,1,2,2,2,2,2,2)
filter = c(T,F,T,T,T,T,T,F,T,T)
n=3
no_label=T
grouped_ngrams(words,group,n, label=F, hash=T)
source('~/Dropbox/tcorpus/R/preprocessing.r')
source('~/Dropbox/tcorpus/R/document_term_matrix.r')
source('~/Dropbox/tcorpus/R/document_term_matrix.r')
words = c('this','is','a','test','this','is','a','glorious','test','ok')
words = as.factor(words)
group = c(1,1,1,1,2,2,2,2,2,2)
filter = c(T,F,T,T,T,T,T,F,T,T)
n=3
no_label=T
grouped_ngrams(words,group,n, label=F, hash=T)
grouped_ngrams(words,group,n, label=F)
grouped_ngrams(words,group,n, label=T)
ngrams = matrix(ncol=n, nrow=length(words))
for(i in 1:n) ngrams[,n-i+1] = shift(words, n=i-1, fill = '')
newart = which(!duplicated(group))
for(i in 1:(n-1)) {
replace_i = newart+i-1
replace_i = replace_i[replace_i <= nrow(ngrams)]
if (length(replace_i) > 0) ngrams[replace_i, 1:(n-i)] = ''
}
ngrams = split(t(ngrams), rep(1:nrow(ngrams), each = ncol(ngrams)))
ngrams
ungrams = unique(ngrams)
ngrams_i = match(ngrams, ungrams)
is(words, 'factor')
ungrams
ngrams
ngrams = matrix(ncol=n, nrow=length(words))
for(i in 1:n) ngrams[,n-i+1] = shift(words, n=i-1, fill = '')
newart = which(!duplicated(group))
for(i in 1:(n-1)) {
replace_i = newart+i-1
replace_i = replace_i[replace_i <= nrow(ngrams)]
if (length(replace_i) > 0) ngrams[replace_i, 1:(n-i)] = ''
}
ngrams
if (is(words, 'factor')) ngrams = as.numeric(ngrams)
ngrams
ngrams
ngrams = split(t(ngrams), rep(1:nrow(ngrams), each = ncol(ngrams)))
ngrams = matrix(ncol=n, nrow=length(words))
for(i in 1:n) ngrams[,n-i+1] = shift(words, n=i-1, fill = '')
newart = which(!duplicated(group))
for(i in 1:(n-1)) {
replace_i = newart+i-1
replace_i = replace_i[replace_i <= nrow(ngrams)]
if (length(replace_i) > 0) ngrams[replace_i, 1:(n-i)] = ''
}
ngrams = split(as.numeric(t(ngrams)), rep(1:nrow(ngrams), each = ncol(ngrams)))
ngrams
ngrams
ungrams = unique(ngrams)
ngrams_i = match(ngrams, ungrams)
ungrams
ungrams
sapply(ngrams, function(x) ifelse(is.na(x), '', levels(word)[x]))
sapply(ngrams, function(x) ifelse(is.na(x), '', levels(words)[x]))
ngrams
ungrams
sapply(ungrams, function(x) ifelse(is.na(x), '', levels(words)[x]))
sapply(ungrams, function(x) ifelse(is.na(x), '', levels(words)[x]), simplify = F)
source('~/Dropbox/tcorpus/R/preprocessing.r')
words = c('this','is','a','test','this','is','a','glorious','test','ok')
words = as.factor(words)
group = c(1,1,1,1,2,2,2,2,2,2)
filter = c(T,F,T,T,T,T,T,F,T,T)
n=3
no_label=T
grouped_ngrams(words,group,n, label=T)
grouped_ngrams(words,group,n, label=F)
grouped_ngrams(words,group,n, label=T)
words
grouped_ngrams(words,group,n, label=T)
source('~/Dropbox/tcorpus/R/preprocessing.r')
words = c('this','is','a','test','this','is','a','glorious','test','ok')
words = as.factor(words)
group = c(1,1,1,1,2,2,2,2,2,2)
filter = c(T,F,T,T,T,T,T,F,T,T)
n=3
no_label=T
grouped_ngrams(words,group,n, label=T)
grouped_ngrams(words,group,n, label=F)
source('~/Dropbox/tcorpus/R/preprocessing.r')
source('~/Dropbox/tcorpus/R/preprocessing.r')
grouped_ngrams(words,group,n, label=F)
grouped_ngrams(words,group,n, label=T)
grouped_ngrams(words,group,n, hash=T)
source('~/Dropbox/tcorpus/R/preprocessing.r')
source('~/Dropbox/tcorpus/R/document_term_matrix.r')
m = Matrix::rsparsematrix()
m = Matrix::rsparsematrix(10,10,1)
m
dimnames(m) = list(1:10, NULL)
m
source('~/Dropbox/tcorpus/R/document_term_matrix.r')
source('~/Dropbox/tcorpus/R/document_term_matrix.r')
source('~/Dropbox/tcorpus/R/document_term_matrix.r')
source('~/Dropbox/tcorpus/R/document_term_matrix.r')
source('~/Dropbox/tcorpus/R/preprocessing.r')
words = c('this','is','a','test','this','is','a','glorious','test','ok')
words = as.factor(words)
group = c(1,1,1,1,2,2,2,2,2,2)
filter = c(T,F,T,T,T,T,T,F,T,T)
n=3
grouped_ngrams(words,group,n, label=F)
grouped_ngrams(words,group,n, label=T)
grouped_ngrams(words,group,n, hash=T)
source('~/Dropbox/tcorpus/R/preprocessing.r')
words = c('this','is','a','test','this','is','a','glorious','test','ok')
words = as.factor(words)
group = c(1,1,1,1,2,2,2,2,2,2)
filter = c(T,F,T,T,T,T,T,F,T,T)
n=3
grouped_ngrams(words,group,n, label=F)
grouped_ngrams(words,group,n, label=T)
grouped_ngrams(words,group,n, hash=T)
grouped_ngrams(words,group,n, hash=T)
source('~/Dropbox/tcorpus/R/preprocessing.r')
words = c('this','is','a','test','this','is','a','glorious','test','ok')
words = as.factor(words)
group = c(1,1,1,1,2,2,2,2,2,2)
filter = c(T,F,T,T,T,T,T,F,T,T)
n=3
grouped_ngrams(words,group,n, label=F)
grouped_ngrams(words,group,n, label=T)
grouped_ngrams(words,group,n, hash=T)
source('~/Dropbox/tcorpus/R/preprocessing.r')
source('~/Dropbox/tcorpus/R/document_term_matrix.r')
x = 1
levels(x)
source('~/Dropbox/tcorpus/R/document_term_matrix.r')
tc = demo_tc
source('~/Dropbox/tcorpus/R/document_term_matrix.r')
library(tcorpus)
tc = demo_tc()
tc$dtm('word')
library(tcorpus)
text = c('Renewable fuel is better than fossil fuels!',
'A fueled debate about fuel',
'Mark Rutte is simply Rutte')
tc = create_tcorpus(text)
tc$dtm('word')
source('~/Dropbox/tcorpus/R/tcorpus.r')
library(tcorpus)
source('~/Dropbox/tcorpus/R/tcorpus.r')
library(tcorpus)
sourceall()
library(tcorpus)
text = c('Renewable fuel is better than fossil fuels!',
'A fueled debate about fuel',
'Mark Rutte is simply Rutte')
tc = create_tcorpus(text)
tc_withNA = tc$search_recode('word', NA, 'Rutte OR Renewable')
tc_withNA$data()
g = tc_withNA$semnet('word', measure = 'count_undirected')
tc_withNA
tc_withNA
g = tc_withNA$semnet_window('word', window.size = 10, n.batches = NA)
expect_true(!'Rutte' %in% V(g)$name)
source('~/Dropbox/tcorpus/R/document_term_matrix.r')
tc = create_tcorpus(text)
g = tc_withNA$semnet('word', measure = 'count_undirected')
tc_withNA = tc$search_recode('word', NA, 'Rutte OR Renewable')
g = tc_withNA$semnet('word', measure = 'count_undirected')
source('~/Dropbox/tcorpus/R/document_term_matrix.r')
tc_withNA = tc$search_recode('word', NA, 'Rutte OR Renewable')
g = tc_withNA$semnet('word', measure = 'count_undirected')
source('~/Dropbox/tcorpus/R/document_term_matrix.r')
library(tcorpus)
text = c('Renewable fuel is better than fossil fuels!',
'A fueled debate about fuel',
'Mark Rutte is simply Rutte')
tc = create_tcorpus(text)
tc$dtm('word')
tc$dtm('word', ngrams = 3)
source('~/Dropbox/tcorpus/R/document_term_matrix.r')
tc$dtm('word', ngrams = 3)
test = vector('factor', 10)
test
test = vector('character', 10)
test
test = as.factor(rep(1, 10))
test
test = as.factor(NA)
test
test = as.factor(rep(NA,10)
)
test
test[1:5] = as.factor('test')
levels(test)
source('~/Dropbox/tcorpus/R/preprocessing.r')
words = c('this','is','a','test','this','is','a','glorious','test','ok')
words = as.factor(words)
group = c(1,1,1,1,2,2,2,2,2,2)
filter = c(T,F,T,T,T,T,T,F,T,T)
n=3
grouped_ngrams(words,group,n, label=F)
grouped_ngrams(words,group,n, label=T)
grouped_ngrams(words,group,n, hash=T)
source('~/Dropbox/tcorpus/R/preprocessing.r')
filter = c(T,F,T,T,T,T,T,F,T,T)
grouped_ngrams(words,group,n, label=T, filter = filter)
source('~/Dropbox/tcorpus/R/preprocessing.r')
tc$dtm('word', ngrams = 3)
tc$dtm('word', ngrams = 1)
tc$dtm('word', ngrams = 2)
source('~/Dropbox/tcorpus/R/document_term_matrix.r')
source('~/Dropbox/tcorpus/R/preprocessing.r')
source('~/Dropbox/tcorpus/R/preprocessing.r')
library(tcorpus)
text = c('Renewable fuel is better than fossil fuels!',
'A fueled debate about fuel',
'Mark Rutte is simply Rutte')
tc = create_tcorpus(text)
tc$dtm('word', ngrams = 2, )
tc$dtm('word', ngrams = 2)
tc$dtm('word', ngrams = 5)
tc$dtm('word', ngrams = 5, feature_labels = F)
source('~/Dropbox/tcorpus/R/compare_documents.r')
source('~/Dropbox/tcorpus/R/compare_documents.r')
source('~/Dropbox/tcorpus/R/tcorpus.r')
library(tcorpus)
text = c('Renewable fuel is better than fossil fuels!',
'A fueled debate about fuel',
'Mark Rutte is simply Rutte')
tc = create_tcorpus(text)
g = tc$compare_documents()
g
plot(g)
E(g)$weight
expect_equal(E(g)$weight, 0.1581139 0.1336306 0.1581139 0.1336306)
library(testthat)
expect_equal(E(g)$weight, 0.1581139 0.1336306 0.1581139 0.1336306)
expect_equal(E(g)$weight, c(0.1581139 0.1336306 0.1581139 0.1336306))
E(g)$weight
c(0.1581139 0.1336306 0.1581139 0.1336306)
expect_equal(E(g)$weight, c(0.1581139, 0.1336306, 0.1581139, 0.1336306))
expect_equal(round(E(g)$weight,3), round(c(0.1581139, 0.1336306, 0.1581139, 0.1336306),3))
g = tc$compare_documents(to_subset = doc_id == '111541965')
tc$meta()
g = tc$compare_documents(to_subset = doc_id == '1')
g
expect_true(ecount(g), 2)
ecount(g)
expect_true(ecount(g) == 2)
g = tc$compare_documents(date_col = 'date')
tc = demo_tc()
g = tc$compare_documents(date_col = 'date')
data.frame(text = c('Renewable fuel is better than fossil fuels!',
'A fueled debate about fuel',
'Mark Rutte is simply Rutte'),
date = c('2010-01-01','2010-01-01','2012-01-01')
tc = create_tcorpus(text)
data.frame(text = c('Renewable fuel is better than fossil fuels!',
'A fueled debate about fuel',
'Mark Rutte is simply Rutte'),
date = c('2010-01-01','2010-01-01','2012-01-01'))
d = data.frame(text = c('Renewable fuel is better than fossil fuels!',
'A fueled debate about fuel',
'Mark Rutte is simply Rutte'),
date = c('2010-01-01','2010-01-01','2012-01-01'))
tc = create_tcorpus(d)
tc
g = tc$compare_documents()
expect_equal(round(E(g)$weight,3), round(c(0.1581139, 0.1336306, 0.1581139, 0.1336306),3))
g = tc$compare_documents(to_subset = doc_id == '1')
expect_true(ecount(g) == 2)
g = tc$compare_documents(date_col = 'date')
g
is.directed(g)
expect_true(is.directed(g))
expect_true(ecount(g) == 4)
g = tc$compare_documents(date_col = 'date', hour_window = c(0,36), to_subset = doc_id == '111541965')
g = tc$compare_documents(date_col = 'date', hour_window = c(0,36))
g = tc$compare_documents(date_col = 'date', hour_window = c(0,36))
tc
g = tc$compare_documents(date_col = 'date', hour_window = c(0,36))
source('~/Dropbox/tcorpus/R/tcorpus.r')
source('~/Dropbox/tcorpus/R/tcorpus.r')
source('~/Dropbox/tcorpus/R/compare_documents.r')
source('~/Dropbox/tcorpus/R/compare_documents.r')
g = tc$compare_documents(date_col = 'date', hour_window = c(0,36))
source('~/Dropbox/tcorpus/R/compare_documents.r')
g = tc$compare_documents(date_col = 'date', hour_window = c(0,36))
g
g = tc$compare_documents(date_col = 'date', hour_window = c(0,36))
expect_true(is.directed(g))
expect_true(ecount(g) == 2)
source('~/Dropbox/tcorpus/R/tcorpus.r')
d = data.frame(text = c('Renewable fuel is better than fossil fuels!',
'A fueled debate about fuel',
'Mark Rutte is simply Rutte'),
date = c('2010-01-01','2010-01-01','2012-01-01'))
tc = create_tcorpus(d)
source('~/Dropbox/tcorpus/R/tcorpus.r')
d = data.frame(text = c('Renewable fuel is better than fossil fuels!',
'A fueled debate about fuel',
'Mark Rutte is simply Rutte'),
date = c('2010-01-01','2010-01-01','2012-01-01'))
tc = create_tcorpus(d)
test = tc$deduplicate('word', similarity = 0.5)
tc$deduplicate
test = tc$deduplicate(feature='word', similarity = 0.5)
test = tc$deduplicate(feature='word')
tc$deduplicate
source('~/Dropbox/tcorpus/R/tcorpus.r')
tc = create_tcorpus(d)
test = tc$deduplicate(feature='word')
source('~/Dropbox/tcorpus/R/compare_documents.r')
test = tc$deduplicate(feature='word')
test = tc$deduplicate(feature='word', similarity = 0.3)
test = tc$deduplicate(feature='word', similarity = 0.5)
RNewsflow::document.network
source('~/Dropbox/tcorpus/R/compare_documents.r')
source('~/Dropbox/tcorpus/R/compare_documents.r')
source('~/Dropbox/tcorpus/R/compare_documents.r')
source('~/Dropbox/tcorpus/R/compare_documents.r')
source('~/Dropbox/tcorpus/R/compare_documents.r')
library(tcorpus)
d = data.frame(text = c('Renewable fuel is better than fossil fuels!',
'A fueled debate about fuel',
'Mark Rutte is simply Rutte'),
date = c('2010-01-01','2010-01-01','2012-01-01'))
tc = create_tcorpus(d)
test = tc$deduplicate(feature='word', similarity = 0.5)
test = tc$deduplicate(feature='word', similarity = 0.5)
test = tc$deduplicate(feature='word', similarity = 0.2)
test = tc$deduplicate(feature='word', similarity = 0.1)
dedup = tc$deduplicate(feature='word', similarity = 0.1)
dedup$n
dedup
dedup$n_meta
library(tcorpus)
d = data.frame(text = c('Renewable fuel is better than fossil fuels!',
'A fueled debate about fuel',
'Mark Rutte is simply Rutte'),
date = c('2010-01-01','2010-01-01','2012-01-01'))
tc = create_tcorpus(d)
#sourceall()
g = tc$compare_documents()
expect_equal(round(E(g)$weight,3), round(c(0.1581139, 0.1336306, 0.1581139, 0.1336306),3))
g = tc$compare_documents(to_subset = doc_id == '1')
expect_true(ecount(g) == 2)
g = tc$compare_documents(date_col = 'date')
expect_true(is.directed(g))
expect_true(ecount(g) == 4)
g = tc$compare_documents(date_col = 'date', hour_window = c(0,36))
expect_true(is.directed(g))
expect_true(ecount(g) == 2)
dedup = tc$deduplicate(feature='word', similarity = 0.1)
expect_true(dedup$n_meta == 1)
library(tcorpus)
g = tc$compare_documents()
tc$compare_documents
tc$compare_documents
tc = create_tcorpus(d)
tc$compare_documents
source('~/Dropbox/tcorpus/R/tcorpus.r')
tc = create_tcorpus(d)
g = tc$compare_documents()
library(tcorpus)
d = data.frame(text = c('Renewable fuel is better than fossil fuels!',
'A fueled debate about fuel',
'Mark Rutte is simply Rutte'),
date = c('2010-01-01','2010-01-01','2012-01-01'))
tc = create_tcorpus(d)
g = tc$compare_documents()
source('~/Dropbox/tcorpus/R/tcorpus.r')
library(tcorpus)
d = data.frame(text = c('Renewable fuel is better than fossil fuels!',
'A fueled debate about fuel',
'Mark Rutte is simply Rutte'),
date = c('2010-01-01','2010-01-01','2012-01-01'))
tc = create_tcorpus(d)
#sourceall()
g = tc$compare_documents()
library(tcorpus)
d = data.frame(text = c('Renewable fuel is better than fossil fuels!',
'A fueled debate about fuel',
'Mark Rutte is simply Rutte'),
date = c('2010-01-01','2010-01-01','2012-01-01'))
tc = create_tcorpus(d)
#sourceall()
g = tc$compare_documents()
library(tcorpus)
compare_documents
library(tcorpus)
library(tcorpus)
d = data.frame(text = c('Renewable fuel is better than fossil fuels!',
'A fueled debate about fuel',
'Mark Rutte is simply Rutte'),
date = c('2010-01-01','2010-01-01','2012-01-01'))
tc = create_tcorpus(d)
g = tc$compare_documents()
library(tcorpus)
d = data.frame(text = c('Renewable fuel is better than fossil fuels!',
'A fueled debate about fuel',
'Mark Rutte is simply Rutte'),
date = c('2010-01-01','2010-01-01','2012-01-01'))
tc = create_tcorpus(d)
g = tc$compare_documents()
d = data.frame(text = c('Renewable fuel is better than fossil fuels!',
'A fueled debate about fuel',
'Mark Rutte is simply Rutte'),
date = c('2010-01-01','2010-01-01','2012-01-01'))
tc = create_tcorpus(d)
g = tc$compare_documents()
library(tcorpus)
library(tcorpus)
d = data.frame(text = c('Renewable fuel is better than fossil fuels!',
'A fueled debate about fuel',
'Mark Rutte is simply Rutte'),
date = c('2010-01-01','2010-01-01','2012-01-01'))
tc = create_tcorpus(d)
g = tc$compare_documents()
compare_documents
source('~/Dropbox/tcorpus/R/tcorpus.r')
source('~/Dropbox/tcorpus/R/tcorpus.r')
library(tcorpus)
d = data.frame(text = c('Renewable fuel is better than fossil fuels!',
'A fueled debate about fuel',
'Mark Rutte is simply Rutte'),
date = c('2010-01-01','2010-01-01','2012-01-01'))
tc = create_tcorpus(d)
library(tcorpus)
g = tc$compare_documents()
tc$compare_documents
tc$compare_documents
tc
library(tcorpus)
d = data.frame(text = c('Renewable fuel is better than fossil fuels!',
'A fueled debate about fuel',
'Mark Rutte is simply Rutte'),
date = c('2010-01-01','2010-01-01','2012-01-01'))
tc = create_tcorpus(d)
library(tcorpus)
d = data.frame(text = c('Renewable fuel is better than fossil fuels!',
'A fueled debate about fuel',
'Mark Rutte is simply Rutte'),
date = c('2010-01-01','2010-01-01','2012-01-01'))
tc = create_tcorpus(d)
sourceall()
tc = create_tcorpus(d)
g = tc$compare_documents()
tc$compare_corpus
tc$compare_documents()
tc$compare_documents
library(tcorpus)
library(tcorpus)
d = data.frame(text = c('Renewable fuel is better than fossil fuels!',
'A fueled debate about fuel',
'Mark Rutte is simply Rutte'),
date = c('2010-01-01','2010-01-01','2012-01-01'))
tc = create_tcorpus(d)
g = tc$compare_documents()
tc$compare_documents
source('~/Dropbox/tcorpus/R/tcorpus.r')
source('~/Dropbox/tcorpus/R/tcorpus.r')
