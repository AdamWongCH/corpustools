multiword_labels(mtc, 'jrc_names')
label = multiword_labels(tc, mword_id, feature=feature) ## for shattered_tCorpus, this has to be done for the entire corpus first, or labels will not match across shards
label = label[order(-label$N),]
label = label[!duplicated(label$id),]
label
label$label = as.factor(label$label)
label$label
f = factor(rep(NA, n_data(tc)), 1:length(levels(labels$label)), levels(labels_label))
rep(NA, n_data(tc))
1:length(levels(labels$label))
labels$label
f = factor(rep(NA, n_data(tc)), 1:length(levels(label$label)), levels(label$label))
f
get_column(tc, mword_id)
match(label$id, get_column(tc, mword_id))
match(get_column(tc, mword_id), label_id)
match(get_column(tc, mword_id), labelTid)
match(get_column(tc, mword_id), label$id)
label$label[match(get_column(tc, mword_id), label$id)]
source('~/Dropbox/tcorpus/R/resources.r')
source('~/Dropbox/tcorpus/R/resources.r')
mtc = feature_from_resource(mtc, 'jrc_names', save_path = '~/Downloads')
source('~/Dropbox/tcorpus/R/resources.r')
source('~/Dropbox/tcorpus/R/resources.r')
tc
tc = mtc
new_feature
new_feature = 'jrc_names'
tc = add_multiword_label(tc, new_feature, feature=feature)
label = multiword_labels(tc, mword_id, feature=feature) ## for shattered_tCorpus, this has to be done for the entire corpus first, or labels will not match across shards
label
label = label[order(-label$N),]
label = label[!duplicated(label$id),]
label$label = as.factor(label$label)
label$label[match(get_column(tc, mword_id), label$id)]
tc = set_column(tc, new_feature, label$label)
label$label
source('~/Dropbox/tcorpus/R/resources.r')
tc = add_multiword_label(tc, new_feature, feature=feature)
get_data(tc)
tests = get_data(tc)
test = get_data(tc)
test[!is.na(test$jrc_names_l),]
multiword_labels(tc, 'jrc_names_i')
multiword_labels(tc, 'jrc_names_l')
source('~/Dropbox/tcorpus/R/resources.r')
testhelp()
library(tcorpus)
testhelp()
tc
tc = feature_from_resource(tc)
source('~/Dropbox/tcorpus/R/resources.r')
tc = feature_from_resource(tc)
source('~/Dropbox/tcorpus/R/resources.r')
source('~/Dropbox/tcorpus/R/resources.r')
tc = feature_from_resource(tc)
14*500000
source('~/Dropbox/tcorpus/R/resources.r')
re = download_jrc_names()
re
source('~/Dropbox/tcorpus/R/resources.r')
re = download_jrc_names()
re
split(re, 2)
candidates[[i]] = fast_multiword_lookup(, fi=fi, regex_sep=regex_sep, case_sensitive=case_sensitive)
split(re, 2)
split(re, get_batch_i(nrow(re), batchsize = 50000, return_vector = T))
x = c(1,1,1,2,2,2,3,3,3,4,4,5,6,7,7)
order(x)
x[order(x)]
order(x)
x[order(x)]
n.batches = ceiling(nrow(re) / batchsize)
batchsize=50000
batchsize=50000
n.batches = ceiling(nrow(re) / batchsize)
n.batches
batch_i = seq(1, n.batches, length.out = 100)
batch_i
batch_i = seq(1, n.batches, along.with = 100)
batch_i
?rep
batch_i = rep(1:n.batches, length.out=100)
batch_i
source('~/Dropbox/tcorpus/R/resources.r')
tc = feature_from_resource(tc)
source('~/Dropbox/tcorpus/R/resources.r')
tc = feature_from_resource(tc)
source('~/Dropbox/tcorpus/R/resources.r')
tc = feature_from_resource(tc)
source('~/Dropbox/tcorpus/R/resources.r')
tc = feature_from_resource(tc)
source('~/Dropbox/tcorpus/R/resources.r')
source('~/Dropbox/tcorpus/R/resources.r')
tc = feature_from_resource(tc)
source('~/Dropbox/tcorpus/R/resources.r')
tc = feature_from_resource(tc)
}
tc
source('~/Dropbox/tcorpus/R/resources.r')
source('~/Dropbox/tcorpus/R/resources.r')
source('~/Dropbox/tcorpus/R/resources.r')
source('~/Dropbox/tcorpus/R/resources.r')
microbenchmark::microbenchmark(tc = feature_from_resource(tc), times=3)
source('~/Dropbox/tcorpus/R/resources.r')
microbenchmark::microbenchmark(tc = feature_from_resource(tc), times=3)
source('~/Dropbox/tcorpus/R/resources.r')
microbenchmark::microbenchmark(tc = feature_from_resource(tc, verbose=F), times=3)
source('~/Dropbox/tcorpus/R/resources.r')
microbenchmark::microbenchmark(tc = feature_from_resource(tc, verbose=F), times=3)
source('~/Dropbox/tcorpus/R/resources.r')
source('~/Dropbox/tcorpus/R/resources.r')
source('~/Dropbox/tcorpus/R/resources.r')
library(tcorpus)
gc()
source('~/Dropbox/tcorpus/R/resources.r')
re = download_jrc_names()
nrow(re)
nrow(re)
length(unique(re$id))
library(tcorpus)
source('~/Dropbox/tcorpus/R/resources.r')
load_resource('jrc_names')
load_resource('jrc_names')
source('~/Dropbox/tcorpus/R/resources.r')
source('~/Dropbox/tcorpus/R/resources.r')
source('~/Dropbox/tcorpus/R/resources.r')
source('~/Dropbox/tcorpus/R/resources.r')
load_resource('jrc_names')
source('~/Dropbox/tcorpus/R/resources.r')
download_resource('jrc_ames')
download_resource('jrc_names')
load_resource('jrc_namdes')
load_resource('jrc_names')
tc = feature_from_resource(tc, verbose=F)
?download_resource
source('~/Dropbox/tcorpus/R/resources.r')
source('~/Dropbox/tcorpus/R/resources.r')
source('~/Dropbox/tcorpus/R/resources.r')
tc = feature_from_resource(tc, verbose=F)
library(tcorpus)
testhelp()
tc = feature_from_resource(tc, verbose=F)
source('~/Dropbox/tcorpus/R/resources.r')
source('~/Dropbox/tcorpus/R/resources.r')
tc
tokens = data.frame(document = c(rep(1, 8), rep(2, 5), rep(3, 5)),
sentence = c(rep(1, 8), rep(2, 5), rep(3, 5)),
id = 1:18,
word = c('Renewable','Barack_Obama','is','better','than','fossil','Donald_Trump','!','A','fueled','debate','about','fuel','Mark','Rutte','is','simply','Rutte'))
tc = tokens_to_tcorpus(tokens, doc_col ='document', word_i_col = 'id')
tc = feature_from_resource(tc, verbose=F)
tc
get_data(tc)
tc = feature_from_resource(tc, verbose=F)
testhelp()
tc = feature_from_resource(tc, verbose=F)
testhelp()
tc
rm(tc)
testhelp()
tc
tc = feature_from_resource(tc, verbose=F)
source('~/Dropbox/tcorpus/R/resources.r')
tokens = data.frame(document = c(rep(1, 8), rep(2, 5), rep(3, 5)),
sentence = c(rep(1, 8), rep(2, 5), rep(3, 5)),
id = 1:18,
word = c('Renewable','Barack_Obama','is','better','than','fossil','Donald_Trump','!','A','fueled','debate','about','fuel','Mark','Rutte','is','simply','Rutte'))
tc = tokens_to_tcorpus(tokens, doc_col ='document', word_i_col = 'id')
tc = feature_from_resource(tc, verbose=T)
source('~/Dropbox/tcorpus/R/resources.r')
source('~/Dropbox/tcorpus/R/resources.r')
tc = tokens_to_tcorpus(tokens, doc_col ='document', word_i_col = 'id')
tc = feature_from_resource(tc, verbose=T)
source('~/Dropbox/tcorpus/R/resources.r')
tc = feature_from_resource(tc, verbose=T)
re = load_resource()
head(re)
re = re[order(re$string),]
class(re)
re = data.table(re)
re = load_resource()
re = data.table(re)
re = re[order(re$string),]
source('~/Dropbox/tcorpus/R/resources.r')
source('~/Dropbox/tcorpus/R/resources.r')
re = load_resource('jrc_names')
source('~/Dropbox/tcorpus/R/resources.r')
make_filename(NULL, resource = 'jrc_names')
head(re)
class(re)
re = data.table(re)
saveRDS(re, make_filename(NULL, resource = 'jrc_names'))
re = load_resource('jrc_names')
class(re)
tc = feature_from_resource(tc, verbose=T)
source('~/Dropbox/tcorpus/R/resources.r')
source('~/Dropbox/tcorpus/R/resources.r')
source('~/Dropbox/tcorpus/R/resources.r')
source('~/Dropbox/tcorpus/R/resources.r')
source('~/Dropbox/tcorpus/R/resources.r')
source('~/Dropbox/tcorpus/R/resources.r')
source('~/Dropbox/tcorpus/R/collocations.r')
tc
d = get_data(tc)
d
source('~/Dropbox/tcorpus/R/collocations.r')
source('~/Dropbox/tcorpus/R/resources.r')
source('~/Dropbox/tcorpus/R/resources.r')
tc = feature_from_resource(tc, verbose=T)
get_data(tc)
source('~/Dropbox/tcorpus/R/resources.r')
4 == 'test'
source('~/Dropbox/tcorpus/R/resources.r')
source('~/Dropbox/tcorpus/R/resources.r')
source('~/Dropbox/tcorpus/R/resources.r')
source('~/Dropbox/tcorpus/R/collocations.r')
source('~/Dropbox/tcorpus/R/collocations.r')
source('~/Dropbox/tcorpus/R/collocations.r')
library(SPARQL) # SPARQL querying package
install.packages('SPARQL')
library(SPARQL)
endpoint <- "http://services.data.gov/sparql"
query <-
"PREFIX  dgp1187: <http://data-gov.tw.rpi.edu/vocab/p/1187/>
SELECT ?ye ?fi ?ac
WHERE {
?s dgp1187:year ?ye .
?s dgp1187:fires ?fi .
?s dgp1187:acres ?ac .
}"
qd <- SPARQL(endpoint,query)
endpoint <- 'http://statistics.gov.scot/sparql'
endpoint = 'http://statistics.gov.scot/sparql'
query = 'PREFIX qb: <http://purl.org/linked-data/cube#>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX sdmx: <http://purl.org/linked-data/sdmx/2009/concept#>
PREFIX data: <http://statistics.gov.scot/data/>
PREFIX sdmxd: <http://purl.org/linked-data/sdmx/2009/dimension#>
PREFIX mp: <http://statistics.gov.scot/def/measure-properties/>
PREFIX stat: <http://statistics.data.gov.uk/def/statistical-entity#>
SELECT ?areaname ?nratio ?yearname ?areatypename WHERE {
?indicator qb:dataSet data:alcohol-related-discharge ;
sdmxd:refArea ?area ;
sdmxd:refPeriod ?year ;
mp:ratio ?nratio .
?year rdfs:label ?yearname .
?area stat:code ?areatype ;'
endpoint = 'http://statistics.gov.scot/sparql'
query = 'PREFIX qb: <http://purl.org/linked-data/cube#>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX sdmx: <http://purl.org/linked-data/sdmx/2009/concept#>
PREFIX data: <http://statistics.gov.scot/data/>
PREFIX sdmxd: <http://purl.org/linked-data/sdmx/2009/dimension#>
PREFIX mp: <http://statistics.gov.scot/def/measure-properties/>
PREFIX stat: <http://statistics.data.gov.uk/def/statistical-entity#>
SELECT ?areaname ?nratio ?yearname ?areatypename WHERE {
?indicator qb:dataSet data:alcohol-related-discharge ;
sdmxd:refArea ?area ;
sdmxd:refPeriod ?year ;
mp:ratio ?nratio .
?year rdfs:label ?yearname .
?area stat:code ?areatype ;
rdfs:label ?areaname .
?areatype rdfs:label ?areatypename .
}'
qd <- sparql(endpoint,query)
library(SPARQL)
qd <- sparql(endpoint,query)
qd <- SPARQL(endpoint,query)
head(qd)
source('~/Dropbox/tcorpus/R/resources.r')
source('~/Dropbox/tcorpus/R/resources.r')
source('~/Dropbox/tcorpus/R/resources.r')
source('~/Dropbox/tcorpus/R/resources.r')
source('~/Dropbox/tcorpus/R/resources.r')
source('~/Dropbox/tcorpus/R/resources.r')
source('~/Dropbox/tcorpus/R/resources.r')
source('~/Dropbox/tcorpus/R/resources.r')
source('~/Dropbox/tcorpus/R/resources.r')
source('~/Dropbox/tcorpus/R/resources.r')
library(tcorpus)
library(tcorpus)
testhelp()
tokens = data.frame(document = c(rep(1, 8), rep(2, 5), rep(3, 5)),
sentence = c(rep(1, 8), rep(2, 5), rep(3, 5)),
id = 1:18,
word = c('Renewable','Barack_Obama','is','better','than','fossil','Donald_Trump','!','A','fueled','debate','about','fuel','Mark','Rutte','is','simply','Rutte'))
tc = tokens_to_tcorpus(tokens, doc_col ='document', word_i_col = 'id')
download_resource('jrc_names')
tc = feature_from_resource(tc, verbose=T)
re = load_resource('jrc_names')
download_resource('jrc_names')
source('~/Dropbox/tcorpus/R/resources.r')
source('~/Dropbox/tcorpus/R/resources.r')
source('~/Dropbox/tcorpus/R/resources.r')
source('~/Dropbox/tcorpus/R/resources.r')
source('~/Dropbox/tcorpus/R/jrc_names.r')
library(tcorpus)
download_resource('jrc_names')
source('~/Dropbox/tcorpus/R/jrc_names.r')
source('~/Dropbox/tcorpus/R/jrc_names.r')
tc = feature_from_resource(tc, verbose=T)
source('~/Dropbox/tcorpus/R/resources.r')
tc = feature_from_resource(tc, verbose=T)
tc
get_data(tc)
source('~/Dropbox/tcorpus/R/resources.r')
source('~/Dropbox/tcorpus/R/collocations.r')
source('~/Dropbox/tcorpus/R/collocations.r')
source('~/Dropbox/tcorpus/R/collocations.r')
source('~/Dropbox/tcorpus/R/collocations.r')
library(tcorpus)
source('~/Dropbox/tcorpus/R/lookup_lists.r')
library(tcorpus)
testhelp()
tokens = data.frame(document = c(rep(1, 8), rep(2, 5), rep(3, 5)),
sentence = c(rep(1, 8), rep(2, 5), rep(3, 5)),
id = 1:18,
word = c('Renewable','Barack_Obama','is','better','than','fossil','Donald_Trump','!','A','fueled','debate','about','fuel','Mark','Rutte','is','simply','Rutte'))
tc = tokens_to_tcorpus(tokens, doc_col ='document', word_i_col = 'id')
library(tcorpus)
tc = feature_from_resource(tc, verbose=T)
download_resource('jrc_names')
tc = feature_from_resource(tc, verbose=T)
get_data(tc)
library(tcorpus)
testhelp()
tokens = data.frame(document = c(rep(1, 8), rep(2, 5), rep(3, 5)),
sentence = c(rep(1, 8), rep(2, 5), rep(3, 5)),
id = 1:18,
word = c('Renewable','Barack_Obama','is','better','than','fossil','Donald_Trump','!','A','fueled','debate','about','fuel','Mark','Rutte','is','simply','Rutte'))
tc = tokens_to_tcorpus(tokens, doc_col ='document', word_i_col = 'id')
tc = feature_from_resource(tc, verbose=T)
get_data(tc)
source('~/Dropbox/tcorpus/R/resources.r')
source('~/Dropbox/tcorpus/R/resources.r')
library(tcorpus)
library(tcorpus)
library(tcorpus)
library(tcorpus)
devtools::install_github('kasperwelbers/tcorpus')
library(tcorpus)
tokens = data.frame(document = c(rep(1, 8), rep(2, 5), rep(3, 5)),
sentence = c(rep(1, 8), rep(2, 5), rep(3, 5)),
id = 1:18,
word = c('Renewable','Barack_Obama','is','better','than','fossil','Donald_Trump','!','A','fueled','debate','about','fuel','Mark','Rutte','is','simply','Rutte'))
tc = tokens_to_tcorpus(tokens, doc_col ='document', word_i_col = 'id')
download_resource('jrc_names')
download_resource('jrc_names')
download_resource('jrc_names')
download_resource('jrc_names')
local_path=NULL
resource='jrc_names'
resource = paste(resource, 'rds', sep='.')
path = system.file('tcorpus_ext_resources', package='tcorpus')
path
path = system.file(package='tcorpus')
path
load_resource('jrc_names')
resources_path
path = system.file('tcorpus_ext_resources', package='tcorpus')
path
path = system.file('inst', package='tcorpus')
path
path = system.file('inst/tcorpus_ext_resources', package='tcorpus')
path
path = system.file(package='tcorpus')
path
source('~/Dropbox/tcorpus/R/resources.r')
source('~/Dropbox/tcorpus/R/resources.r')
library(tcorpus)
source('~/Dropbox/tcorpus/R/resources.r')
library(tcorpus)
tokens = data.frame(document = c(rep(1, 8), rep(2, 5), rep(3, 5)),
sentence = c(rep(1, 8), rep(2, 5), rep(3, 5)),
id = 1:18,
word = c('Renewable','Barack_Obama','is','better','than','fossil','Donald_Trump','!','A','fueled','debate','about','fuel','Mark','Rutte','is','simply','Rutte'))
tc = tokens_to_tcorpus(tokens, doc_col ='document', word_i_col = 'id')
download_resource('jrc_names')
source('~/Dropbox/tcorpus/R/resources.r')
source('~/Dropbox/tcorpus/R/resources.r')
library(tcorpus)
download_resource('jrc_names')
resource = paste(resource, 'rds', sep='.')
resource
resource = 'jrc_names'
resource = paste(resource, 'rds', sep='.')
path = system.file(package='tcorpus')
path
path = paste(path, 'tcorpus_ext_resources', resource, sep='/')
dir.exists(path)
if(!dir.exists(path)) dir.create(path)
path = system.file(package='tcorpus')
path = paste(path, 'tcorpus_ext_resources', sep='/')
path
if(!dir.exists(path)) dir.create(path)
paste(path, 'resource', sep='/')
path = system.file(package='tcorpus')
path = paste(path, 'tcorpus_ext_resources', sep='/')
paste(path, resource, sep='/')
source('~/Dropbox/tcorpus/R/resources.r')
source('~/Dropbox/tcorpus/R/resources.r')
library(tcorpus)
library(tcorpus)
tokens = data.frame(document = c(rep(1, 8), rep(2, 5), rep(3, 5)),
sentence = c(rep(1, 8), rep(2, 5), rep(3, 5)),
id = 1:18,
word = c('Renewable','Barack_Obama','is','better','than','fossil','Donald_Trump','!','A','fueled','debate','about','fuel','Mark','Rutte','is','simply','Rutte'))
tc = tokens_to_tcorpus(tokens, doc_col ='document', word_i_col = 'id')
download_resource('jrc_names')
test_jrcnames()
test_jrcnames <- function(){
download_resource('jrc_names')
tc = feature_from_resource(tc, verbose=T)
get_data(tc)
}
test_jrcnames()
d = get_data(tc)
d
tc = feature_from_resource(tc, verbose=T)
d = get_data(tc)
d
library(testthat)
d$jrc_names
na.omit(d$jrc_names)
na.omit(d$jrc_names_l)
class(d$jrc_names)
test_jrcnames()
expect_equal(as.numeric(na.omit(d$jrc_names)), c(1510,2042,76099, 76099))
as.numeric(na.omit(d$jrc_names)
as.numeric(na.omit(d$jrc_names))
as.numeric(na.omit(d$jrc_names))
as.character(na.omit(d$jrc_names))
expect_equal(as.character(na.omit(d$jrc_names)), c('1510','2042','76099', '76099'))
expect_equal(as.character(na.omit(d$jrc_names_l)), c('Barack Obama','Donald Trump', 'Mark Rutte'))
na.omit(d$jrc_names_l))
na.omit(d$jrc_names_l))
na.omit(d$jrc_names_l)
expect_equal(as.character(na.omit(d$jrc_names_l)), c('Barack Obama','Donald Trump', 'Mark Rutte', 'Mark Rutte'))
source('~/Dropbox/tcorpus/R/resources.r')
source('~/Dropbox/tcorpus/R/resources.r')
source('~/Dropbox/tcorpus/R/resources.r')
source('~/Dropbox/tcorpus/R/resources.r')
options('test', 0)
options()
options('test')
getOption('test', 1)
getOption('test', NULL)
getOption('tcorpus_resources', NULL)
options(tcorpus_resources='test')
getOption('tcorpus_resources', NULL)
options(test=1)
getOption('test')
options(test=5)
getOption('test')
source('~/Dropbox/tcorpus/R/resources.r')
source('~/Dropbox/tcorpus/R/resources.r')
source('~/Dropbox/tcorpus/R/resources.r')
source('~/Dropbox/tcorpus/R/resources.r')
source('~/Dropbox/tcorpus/R/resources.r')
library(tcorpus)
library(tcorpus)
tokens = data.frame(document = c(rep(1, 8), rep(2, 5), rep(3, 5)),
sentence = c(rep(1, 8), rep(2, 5), rep(3, 5)),
id = 1:18,
word = c('Renewable','Barack_Obama','is','better','than','fossil','Donald_Trump','!','A','fueled','debate','about','fuel','Mark','Rutte','is','simply','Rutte'))
tc = tokens_to_tcorpus(tokens, doc_col ='document', word_i_col = 'id')
set_resources_path('')
test_jrcnames(tc)
test_jrcnames <- function(tc){
capture_output({
getOption('tcorpus_resources', NULL)
download_resource('jrc_names')
tc = feature_from_resource(tc, verbose=T)
d = get_data(tc)
})
expect_equal(as.character(na.omit(d$jrc_names)), c('1510','2042','76099', '76099'))
expect_equal(as.character(na.omit(d$jrc_names_l)), c('Barack Obama','Donald Trump', 'Mark Rutte', 'Mark Rutte'))
}
test_jrcnames(tc)
download_resource
getOption('tcorpus_resources', NULL)
set_resources_path('~/Downloads') ## store locally for repeated use (since building the package removes the resources directory)
test_jrcnames(tc)
source('~/Dropbox/tcorpus/R/resources.r')
library(tcorpus)
library(tcorpus)
tokens = data.frame(document = c(rep(1, 8), rep(2, 5), rep(3, 5)),
sentence = c(rep(1, 8), rep(2, 5), rep(3, 5)),
id = 1:18,
word = c('Renewable','Barack_Obama','is','better','than','fossil','Donald_Trump','!','A','fueled','debate','about','fuel','Mark','Rutte','is','simply','Rutte'))
tc = tokens_to_tcorpus(tokens, doc_col ='document', word_i_col = 'id')
set_resources_path('~/Downloads') ## store locally for repeated use (since building the package removes the resources directory)
test_jrcnames(tc)
test_jrcnames <- function(tc){
capture_output({
getOption('tcorpus_resources', NULL)
download_resource('jrc_names')
tc = feature_from_resource(tc, verbose=T)
d = get_data(tc)
})
expect_equal(as.character(na.omit(d$jrc_names)), c('1510','2042','76099', '76099'))
expect_equal(as.character(na.omit(d$jrc_names_l)), c('Barack Obama','Donald Trump', 'Mark Rutte', 'Mark Rutte'))
}
test_jrcnames(tc)
test_jrcnames(tc)
options()
names(options())
getOption('download_file_method')
getOption('download.file.method')
source('~/Dropbox/tcorpus/R/resources.r')
